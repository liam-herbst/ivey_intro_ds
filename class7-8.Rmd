---
title: "advertising.Rmd"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


Read the advertising.csv data set
```{r}
#Read CSV into R

AdData <- read.csv("~/downloads/advertising.csv", header=TRUE)

#Display the first few elements of the data to make sure that data is read
head(AdData)
```

```{r}
# *scatter plot* of the data

plot(AdData$TV, AdData$sales, pch=3)
plot(AdData$radio, AdData$sales, pch = 20)
plot(AdData$newspaper, AdData$sales, pch = 20)
```

```{r}
pairs(AdData) ### Confirm that this is the proper visualization
```


Get the correlation matrix to prepare the data for regression
```{r}
#cor == correlation. The blank area before the comma below means that we take ALL rows
cor(AdData[ , 1:3])
```
We don't want to see correlations that are > 0.4 or < -0.4

We also didn't include the column 4 (sales) as this column is for y

You can round digits for clarity

```{r}
round(cor(AdData[ , 1:3]), 2)
```

Create a regression Model to predict sales

Approach 1:

```{r}
#Create Regression Model
regModel <- lm(AdData$sales ~ AdData$TV + AdData$radio + AdData$newspaper)
```

Approach 2:

```{r}
# Create Regression Model
regModel <- lm(sales ~ TV + radio + newspaper, data = AdData)
```

Approach 3:

```{r}
# Create Regression Model
regModel <- lm(sales ~ ., data = AdData)
```

The p value, R-squared and scatter plots will demonstrate whether the variables are a good fit

```{r}
summary(regModel)
```
The p value (Pr(>|t|) column above) is less than 0.05 for TV and radio but not for newspaper (0.86). This tells us that newspaper is not a good predictor and it should be removed from our model.

R-squared is a measure of accuracy. R-squared doesn't exist in more complicated ML models. Residuals are what we'll look for.
The r-squared value is 0.89 is quite high which indicates the model is accurate.


The line of best fit: y = 2.9 + 0.04TV + 0.19radio -0.001newspaper
This represents us finding values for each of the features

Residuals (see top of summary report above): the difference between the prediction and the actual data set (Residual = prediction - actual)
Residuals are a measure of model accuracy. Ideally, the min and max are as close as possible to zero. The size of the residuals is represented by the distance the data point is from the trend line.

Create a new model with eliminating newspaper

Option 1:
```{r}
# Create Regression Model
regModel <- lm(sales ~ TV + radio, data = AdData)
```

Option 2:
```{r}
# Create Regression Model
regModel <- lm(sales ~ . - newspaper, data = AdData)
summary(regModel)
```
Newspaper has been eliminated. It is very important to get rid of data that is irrelevant (noisy data)

There is not much difference at all in the model's residuals, coefficients or r-squared. 

```{r}
#Example of coefs_TV model
summary(coef(regModel_TV))
```


```{r}
# Model for one variable
regModel_TV <- lm(AdData$sales ~ AdData$TV)

# Plot data and regression equation
coefs_TV = coef(regModel_TV)
plot(AdData$TV, AdData$sales, pch=20, col='red')
abline(coefs_TV[1], coefs_TV[2])
```
[In abline, coefs_TV[1] is the intercept, and coefs_TV[2] is the sales)

There are two main problems with this graph. The lower left curve is... a curve and cannot be represented by a linear regression. The second problem is the upper right bound are consistently increasing. 

```{r}
AdData$sqrtTV <- sqrt(AdData$TV)
head(AdData)
```
```{r}
nonlinear_regModel <- lm(sales ~ sqrtTV, data = AdData)
```

```{r}
summary(nonlinear_regModel)
```

The residuals are smaller with the new model which insinuates that it is more accurate. (despite the r-squared being lower)

This model: sales = 0.99(sqrtTV) + 2.6724 #intercept
It is a linear regression model that is non-linear